import{r as o,j as e,S as L,g as C}from"./index-DLHo9G1O.js";import{S as O}from"./SideBar-CZYepFO2.js";import{a as p}from"./index-CHcUfME0.js";import{u as $}from"./useModal-Bg4NtOj9.js";import{d as G}from"./dayjs.min-BweiAIR_.js";import"./index-6t7-0j-N.js";import"./iconBase-7BRcTMO3.js";import"./index-50VzBKPQ.js";import"./index-Dm_eEFJF.js";import"./index-qAoN58iZ.js";import"./roleAtom-DmcA2hSe.js";import"./index-Secm_Y0z.js";const M=()=>{var N,y,b,v;const[m,j]=o.useState([]),[w,h]=o.useState([]),[f,u]=o.useState(!1),l=window.sessionStorage.getItem("restaurantId"),{Modal:a,open:c,close:i,eventData:s}=$({title:"주문 정보를 확인해주세요"});o.useEffect(()=>{(async()=>{const t={restaurantId:l};try{const n=await p.get("/api/order/restaurant/reservation",{params:t}),d=n.data.resultData;console.log(n),console.log(d);const x=d.map(k=>k.orderDetails?k.orderDetails:[]);console.log(x.flat()),j([...d]),h([...x.flat()])}catch(n){console.log(n)}})()},[f]);const g=()=>u(r=>!r),I=async()=>{console.log(s);const r={orderId:s.orderId,reservationStatus:1};try{const t=await p.put("/api/order/access",r);console.log(t),L.fire({title:"주문을 승인했습니다!",text:"주문을 확인해주세요.",icon:"success"}),i(),g()}catch(t){console.log(t)}},S=async()=>{const r={orderId:s.orderId,reservationStatus:2};try{const t=await p.put("/api/order/access",r);console.log(t),i(),g()}catch(t){console.log(t)}};return e.jsx("div",{className:"flex flex-col w-2/5 h-dvh border-l-2 bg-white border-l-gray shadow-xl",children:e.jsxs("div",{className:"w-100% h-dvh",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex w-100% h-100% flex-col text-center pt-10 text-2xl mb-6 font-semibold",children:"새로운 주문"}),e.jsxs("div",{className:"flex w-full items-center justify-between px-6 py-2 border-b border-gray",children:[e.jsx("span",{className:"flex w-[30%] justify-center text-darkGray",children:"주문번호"}),e.jsx("span",{className:"flex w-[40%] justify-center text-darkGray",children:"메뉴"}),e.jsx("span",{className:"flex w-[30%] justify-center text-darkGray",children:"주문시간"})]})]}),e.jsx("ul",{className:"flex flex-col w-[100%] h-[100%] gap-4 pt-3 text-nowrap",children:m.map((r,t)=>{var n;return r.length===0?e.jsx("li",{className:"flex w-full items-center justify-between px-6 py-2",children:e.jsx("span",{children:"새로운 주문이 없습니다"})},r):e.jsxs("li",{onClick:()=>c(r),className:"flex w-full items-center justify-between px-6 py-2 border-b border-gray",children:[e.jsx("span",{className:"flex w-[30%] justify-center text-black",children:r.orderId}),e.jsx("span",{className:"flex flex-col w-[30%] justify-center text-black",children:r.orderDetails.map((d,x)=>e.jsx("div",{className:"truncate",children:d==null?void 0:d.menuName},x))}),e.jsx("span",{className:"flex w-[30%] justify-center text-black",children:(n=r.orderDetails[0].createdAt.split(" "))==null?void 0:n[1].slice(0,5)})]},t)})}),e.jsx(a,{children:e.jsxs("div",{className:"flex flex-col w-full h-full justify-between",children:[e.jsxs("div",{className:"flex flex-col w-full h-[60%] gap-4 pt-10 items-center",children:[e.jsxs("div",{className:"flex w-full px-10 gap-3",children:[e.jsx("span",{className:"flex w-[25%]",children:"주문번호"}),e.jsx("span",{className:"text-xl",children:s==null?void 0:s.orderId})]}),e.jsxs("div",{className:"flex w-full px-10 gap-3 items-center",children:[e.jsx("span",{className:"flex w-[25%]",children:"주문한 메뉴"}),e.jsx("span",{className:"text-xl",children:(N=s==null?void 0:s.orderDetails)==null?void 0:N.menuName})]}),e.jsxs("div",{className:"flex w-full px-10 gap-3 items-center",children:[e.jsx("span",{className:"flex w-[25%]",children:"주문한 사람"}),e.jsx("span",{className:"text-xl",children:s==null?void 0:s.userName})]}),e.jsxs("div",{className:"flex w-full px-10 gap-3 items-center",children:[e.jsx("span",{className:"flex w-[25%]",children:"핸드폰 번호"}),s.userPhone===null?e.jsx("span",{className:"text-darkGray",children:"등록된 번호가 없어요"}):e.jsx("span",{className:"text-xl",children:(v=(b=(y=s==null?void 0:s.userPhone)==null?void 0:y.replace(/[^0-9]/g,""))==null?void 0:b.replace(/^(\d{0,3})(\d{0,4})(\d{0,4})$/g,"$1-$2-$3"))==null?void 0:v.replace(/(-{1,2})$/g,"")})]}),e.jsxs("div",{className:"flex w-full h-[20%] px-10 gap-3 items-center",children:[e.jsx("span",{className:"flex w-[25%]",children:"인원 수"}),e.jsxs("span",{className:"text-xl",children:[s==null?void 0:s.reservationPeopleCount," 명"]})]})]}),e.jsxs("div",{className:"flex w-full justify-center gap-10 mb-10",children:[e.jsx("div",{onClick:I,className:"bg-blue px-2 py-1 rounded-md text-nowrap text-white font-medium",children:"주문 승인"}),e.jsx("div",{onClick:S,className:"bg-red px-2 py-1 rounded-md text-nowrap text-white font-medium",children:"주문 취소"})]})]})})]})})},_=()=>{const[m,j]=o.useState(!0),[w,h]=o.useState([]),f=sessionStorage.getItem("restaurantId"),u=C();return o.useEffect(()=>{const l={restaurantId:f};(async()=>{try{const c=await p.get("/api/order/restaurant",{params:l,headers:{Authorization:`Bearer ${u}`}});console.log(c.data.resultData);const i=c.data.resultData;h([...i])}catch(c){console.log(c)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-full h-full bg-gray",children:e.jsx("div",{className:"w-100% h-[calc(100%_-_4rem)] mx-4 my-8 bg-white rounded-lg overflow-hidden overflow-y-scroll scrollbar-hide",children:e.jsx("div",{className:"flex flex-wrap ml-5 mt-5 gap-4 bg-white justify-start",children:w.map(l=>e.jsxs("div",{className:`${m?"w-[calc(33%_-_1rem)]":"w-[calc(25%_-_1rem)]"} min-w-40 h-48 border-2 border-darkGray bg-white cursor-pointer`,children:[e.jsxs("div",{className:" px-4 py-1 bg-third",children:[e.jsxs("div",{className:"flex justify-between items-center gap-3",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-nowrap",children:"주문번호"}),e.jsx("span",{className:"text-lg",children:l.orderId})]}),e.jsxs("span",{className:"font-semibold text-nowrap",children:[l==null?void 0:l.orderDetails.reduce((a,c)=>a+c.price,0).toLocaleString("ko-KR")," ","원"]})]}),e.jsxs("div",{className:"flex gap-2 tracking-wider items-center",children:[e.jsx("span",{className:"text-sm",children:"주문시간"}),e.jsxs("span",{className:"text-md",children:[G(l.reservationTime).format("HH:MM")," ~"]})]})]}),e.jsxs("div",{className:"px-3 py-3",children:[l.orderDetails.map((a,c)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:a==null?void 0:a.menuName}),e.jsxs("span",{children:["x",a==null?void 0:a.menuCount]})]},c)),e.jsx("div",{className:"pt-1 pl-6 text-darkGray",children:l.menuInfo})]})]},l.orderId))})})}),e.jsx(M,{})]})},J=()=>e.jsxs("div",{className:"flex w-full h-dvh overflow-hidden scrollbar-hide justify-between",children:[e.jsx(O,{}),e.jsx(_,{})]});export{J as default};
