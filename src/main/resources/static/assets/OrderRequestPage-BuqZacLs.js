import{r as i,R as m,b as $,q as z,t as L,u as M,j as e,S as R}from"./index-8lJcAOoD.js";import{a as p}from"./index-CHcUfME0.js";import{I as E}from"./index-DAM17y8Z.js";import{c as F}from"./index-CbRQZVZ2.js";import{g as T}from"./cookie-DPYybHad.js";import"./iconBase-DY5zKqN8.js";const Q=()=>{var w,b,N,I;const[a,u]=i.useState([]),[x,v]=i.useState({}),[o,h]=i.useState({}),[k,U]=m($),[l,A]=m(z),[C,D]=m(L),g=sessionStorage.getItem("userId"),S=M(),c=T();i.useEffect(()=>{const s={userId:g};(async()=>{try{const r=await p.get("/api/user/orderId",{params:s,headers:{Authorization:`Bearer ${c}`}});console.log(r.data.resultData);const n=r.data.resultData;A(n)}catch(r){console.log(r)}})()},[]),i.useEffect(()=>{const s={orderId:l};(async()=>{try{const r=await p.get("/api/user/user-payment-member/userPaymentMember",{params:s,headers:{Authorization:`Bearer ${c}`}});console.log(r.data.resultData);const n=r.data.resultData;u([...n])}catch(r){console.log(r)}})()},[]);const B=async()=>{const s={orderId:l};try{const t=await p.get("/api/user/user-payment-member/userOrderApprovalAccess",{params:s,headers:{Authorization:`Bearer ${c}`}});console.log(t.data.resultData);const r=t.data.resultData;u([...r.getApprovalStatus])}catch(t){console.log(t)}},O=async()=>{const s={orderId:parseInt(l)};try{const t=await p.post("/api/user/user-payment-member/insTicket",s,{headers:{Authorization:`Bearer ${c}`}});console.log(t.data.resultData);const r=t.data.resultData;D(r),R.fire({title:"결제 완료!",text:"식권이 생성되었습니다.",timer:2e3}),S(`/user/placetoorder/coupon/${C}`)}catch(t){console.log(t)}};console.log(l);const P=async s=>{const t={orderId:l,userId:s,approvalStatus:1};console.log(t);try{const r=await p.patch("/api/user/user-payment-member",t,{headers:{Authorization:`Bearer ${c}`}});console.log(r.data);const n=r.data.resultData}catch(r){console.log(r)}},f=({target:{value:s}},t)=>{console.log(s),console.log(t),v(r=>({...r,[t]:s}))},j=s=>{console.log(s);const t=parseInt(x[s]);console.log("입력값",t,s),o?P(s):(u(r=>{const n=r.map(d=>d.userId===s?{...d,point:t}:d);return n.some(d=>d.userId===s)?n:[...n,{userId:s,point:t}]}),h(r=>({...r,[s]:!r[s]})))};console.log(a);const y=s=>{h(!o)};return e.jsxs("div",{className:"w-full h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide",children:[e.jsxs("div",{className:"flex w-full justify-between py-6 items-center border-b border-gray",children:[e.jsx("div",{className:"flex w-[15%] justify-center",children:e.jsx(E,{className:"text-3xl"})}),e.jsx("span",{className:"text-lg font-semibold",children:"결제 상태"}),e.jsx("div",{className:"w-[15%]",children:e.jsx("span",{className:"text-center px-3 py-1 rounded-md text-white text-opacity-0",children:"ㅇ"})})]}),e.jsxs("div",{className:"flex flex-col w-full h-full gap-6",children:[e.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[e.jsx("span",{className:"flex w-[30%] text-base text-nowrap",children:k.name}),e.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:o[a.userId]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-end px-2",children:(w=a[0])==null?void 0:w.point}),e.jsx("span",{children:"원"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"tel",className:"flex w-full border border-darkGray px-2 text-end rounded-md",placeholder:(b=a[0])==null?void 0:b.point,value:x[g],onChange:s=>{var t;return f(s,(t=a[0])==null?void 0:t.userId)}}),e.jsx("span",{children:"원"})]})}),e.jsxs("div",{className:"flex w-[20%] justify-center gap-2 text-nowrap items-center",children:[e.jsx("span",{onClick:()=>{var s;return j((s=a[0])==null?void 0:s.userId)},className:"bg-blue px-2 text-white font-semibold rounded-md cursor-pointer",children:o[(N=a[0])==null?void 0:N.userId]?"승인":"확인"}),e.jsx("span",{onClick:()=>{var s;return y((s=a[0])==null?void 0:s.userId)},className:"bg-red px-2 text-white font-semibold rounded-md cursor-pointer",children:o[(I=a[0])==null?void 0:I.userId]?"수정":"취소"})]})]}),e.jsx("div",{className:"flex w-full items-center justify-center ",children:e.jsxs("div",{className:"flex gap-2 px-5 py-2 bg-gray rounded-md",children:[e.jsx(F,{className:"text-2xl"}),e.jsx("span",{onClick:()=>B(),className:"text-lg font-medium cursor-pointer",children:"승인 상태 확인"})]})}),a.slice(1).map(s=>e.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[e.jsx("span",{className:"flex w-[30%] text-base text-nowrap",children:s.name}),e.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:o[s.userId]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-end px-2",children:s.point}),e.jsx("span",{children:"원"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"tel",className:"flex w-full border border-darkGray px-2 text-end rounded-md",value:x[s.userId],onChange:t=>f(t,s.userId)}),e.jsx("span",{children:"원"})]})}),e.jsxs("div",{className:"flex w-[20%] justify-center gap-2 text-nowrap items-center",children:[e.jsx("span",{onClick:()=>j(s.userId),className:"bg-blue px-2 text-white font-semibold rounded-md cursor-pointer",children:"승인"}),e.jsx("span",{onClick:()=>y(s.userId),className:"bg-red px-2 text-white font-semibold rounded-md cursor-pointer",children:o[s.userId]?"수정":"취소"})]})]},s.userId)),e.jsxs("div",{className:"flex w-full justify-center gap-10",children:[e.jsx("span",{onClick:()=>O(),className:"bg-primary text-white text-lg px-2 py-1 rounded-md cursor-pointer",children:"결제 요청"}),e.jsx("span",{className:"bg-red text-white text-lg px-2 py-1 rounded-md cursor-pointer",children:"결제 취소"})]})]})]})};export{Q as default};
