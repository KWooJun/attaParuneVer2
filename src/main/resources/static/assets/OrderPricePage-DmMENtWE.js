import{r as n,R as x,o as P,b as S,p as M,q as O,u as R,j as e}from"./index-DgvhuQLs.js";import{a as g}from"./index-CHcUfME0.js";import"./lodash-ps-9DWTQ.js";import{I as $,e as L}from"./index-Bonc72oP.js";import{g as B}from"./cookie-BNspsx3t.js";import"./iconBase-BvS4BhiP.js";const _=()=>{var y;const[E,F]=n.useState({}),[r,N]=n.useState({}),[c,I]=n.useState({}),[d,m]=n.useState(0),[i,v]=x(P),[p,T]=x(S),[u,D]=x(M),[k,z]=x(O),j=R(),l=sessionStorage.getItem("userId"),h=B();n.useEffect(()=>{const s={userId:l};(async()=>{try{const t=await g.get("/api/user/orderId",{params:s,headers:{Authorization:`Bearer ${h}`}});console.log(t.data.resultData);const o=t.data.resultData;v(o)}catch(t){console.log(t)}})()},[]),n.useEffect(()=>{const s={orderId:i};(async()=>{try{const t=await g.get("/api/order",{params:s,headers:{Authorization:`Bearer ${h}`}});console.log(t.data.resultData.totalPrice);const o=t.data.resultData.totalPrice;m(o)}catch(t){console.log(t)}})()},[]);const A=async()=>{const s={orderId:i,userId:u.userId,point:u.point};console.log(s);try{const a=await g.patch("/api/user/user-payment-member",s,{headers:{Authorization:`Bearer ${h}`}});console.log(a.data.resultData),a.data.resultData>=0?(console.log("결제 승인 요청을 보냈습니다"),j(`/user/placetoorder/request/${i}`)):console.log("요청에 실패했습니다. 다시 시도해주세요")}catch(a){console.log(a)}},b=({target:{value:s}},a)=>{console.log(s),N(t=>({...t,[a]:s}))};console.log("금액 : ",r),console.log("사람 : ",u);const w=s=>{I(t=>{const o={...t,[s]:!t[s]};return t[s]?m(f=>f+Number(r[s])):m(f=>f-Number(r[s])),o});const a=parseInt(r[s]);D(t=>({...t,point:[...t.point,a]}))},C=()=>{j(`/user/placetoorder/member/${i}`)};return e.jsxs("div",{className:"w-full h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide",children:[e.jsxs("div",{className:"flex w-full justify-between py-6 items-center border-b border-gray",children:[e.jsx("div",{className:"flex w-[15%] justify-center",children:e.jsx($,{className:"text-3xl"})}),e.jsx("span",{className:"text-lg font-semibold",children:"금액 선택"}),e.jsx("div",{className:"w-[15%]",children:e.jsx("span",{className:"text-center px-3 py-1 rounded-md text-white text-opacity-0",children:"ㅇ"})})]}),e.jsxs("div",{className:"flex flex-col w-full h-full gap-6",children:[e.jsxs("div",{className:"flex w-full justify-center gap-2 pt-4 text-xl",children:[e.jsx("span",{children:"총 결제 금액 : "}),e.jsx("span",{className:`text-end px-2 ${Math.sign(parseInt(d))===-1?"text-red":"text-black"}`,children:d==null?void 0:d.toLocaleString("ko-KR")})]}),e.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[e.jsxs("span",{className:"flex w-[40%] text-base text-nowrap",children:[p.name,"(",p.uid,")"]}),e.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:c[l]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-end px-2",children:(y=r[l])==null?void 0:y.toLocaleString("ko-KR")}),e.jsx("span",{children:"원"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"tel",className:"flex w-[70%] border border-darkGray px-2 text-end rounded-md",onChange:s=>b(s,p.userId),value:r.price}),e.jsx("span",{children:"원"})]})}),e.jsx("div",{className:"flex w-[15%] justify-center gap-2 text-nowrap items-center",children:e.jsx("span",{onClick:()=>w(l),className:"bg-blue px-2 text-white font-medium rounded-md",children:c[l]?"수정":"확인"})})]}),k.slice(1).map(s=>{var a;return e.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[e.jsxs("span",{className:"flex w-[40%] text-base text-nowrap",children:[s.name,"(",s.uid,")"]}),e.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:c[s.userId]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-end px-2",children:(a=r[s.userId])==null?void 0:a.toLocaleString("ko-KR")}),e.jsx("span",{children:"원"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"tel",className:"flex w-[70%] border border-darkGray px-2 text-end rounded-md",onChange:t=>b(t,s.userId),value:r.price}),e.jsx("span",{children:"원"})]})}),e.jsx("div",{className:"flex w-[15%] justify-center gap-2 text-nowrap items-center",children:e.jsx("span",{onClick:()=>w(s.userId),className:"bg-blue px-2 text-white font-medium rounded-md",children:c[s.userId]?"수정":"확인"})})]},s.userId)}),e.jsx("div",{className:"flex w-full h-[5%] justify-center items-center",children:e.jsx(L,{onClick:C,className:"text-3xl"})}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx("span",{onClick:()=>A(),className:"bg-primary text-white text-lg px-2 py-1 rounded-md",children:"승인 요청"})})]})]})};export{_ as default};
