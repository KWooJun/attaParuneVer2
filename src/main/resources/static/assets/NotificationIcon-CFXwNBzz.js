import{k as i,R as t,o as j,u as F,j as e,l as O,S as p,r as S}from"./index-DgvhuQLs.js";import{a as z}from"./index-CHcUfME0.js";import{f as B}from"./index-BDdqncIb.js";import{b as R}from"./index-C8lUTx5V.js";import{g as T}from"./cookie-BNspsx3t.js";const v=i({key:"noticeState",default:[]}),W=i({key:"isWhiteIcon",default:!0}),b=i({key:"isClickIcon",default:!1}),C=i({key:"priceNoticeAtom",default:!1}),w=i({key:"orderNoticeAtom",default:!1}),_=()=>{const[c,y]=t(j),[s,d]=t(v),[m,g]=t(C),[f,u]=t(w),[x,a]=t(b),o=F();console.log(s),console.log(m),console.log(f);const I=()=>{o(`/user/placetoorder/member/${c}`,{state:{orderId:s[1].orderId}}),a(!1)},N=()=>{o(`/user/placetoorder/price/${c}`,{state:{orderId:s[0].orderId}}),a(!1)};return e.jsxs("div",{className:"absolute right-4 w-[80%] bg-white z-50 top-12 border-2 border-darkGray rounded-md pb-6",children:[e.jsx("div",{className:"p-5 font-semibold text-darkGray",children:"알림"}),e.jsxs("div",{className:"flex flex-col px-5 gap-5 font-medium text-nowrap",children:[f?e.jsx("div",{onClick:()=>I(),className:"flex w-full h-[10%]",children:"인원을 선택해주세요."}):e.jsx(e.Fragment,{}),m?e.jsx("div",{onClick:()=>N(),className:"flex w-full h-[10%] text-lg font-medium tracking-wide",children:"새로운 결제 요청이 도착했습니다."}):e.jsx(e.Fragment,{})]})]})},q=()=>{const[c,y]=t(W),[s,d]=t(v),[m,g]=t(C),[f,u]=t(w),[x,a]=t(b),[o,I]=t(O),N=sessionStorage.getItem("userId"),A=T();t(j);const P=p.mixin({toast:!0,position:"center",showConfirmButton:!1,timer:2e3,timerProgressBar:!0,didOpen:n=>{n.onmouseenter=p.stopTimer,n.onmouseleave=p.resumeTimer}});return S.useEffect(()=>{const n={userId:N};console.log(o),(async()=>{var h,k;if(o===!0)try{const l=await z.get("/api/user/alert",{params:n,headers:{Authorization:`Bearer ${A}`}});console.log(l.data.resultData);const r=l.data.resultData;(h=r[0])!=null&&h.orderId?(d(r),console.log("결제 승인 요청이 왔습니다"),g(!0),P.fire({title:"결제 승인 요청이 왔습니다!",text:"알림 메세지를 확인해주세요",icon:"info"})):(k=r[1])!=null&&k.orderId?(d(r),console.log("주문 관련 알림이 도착했습니다"),u(!0)):r.length===0&&(g(!1),u(!1))}catch(l){console.log(l)}})()},[]),console.log(s),e.jsxs("div",{children:[e.jsx("div",{children:e.jsxs("div",{onClick:()=>a(!x),className:"absolute right-5 top-5 z-50",children:[s.length!==0?e.jsx(B,{className:"absolute -right-0 -top-1 text-xs text-red animate-ping"}):e.jsx(e.Fragment,{}),e.jsx(R,{className:`size-6 ${c?"text-white":"text-black"}`})]})}),o?x?e.jsx(_,{}):e.jsx(e.Fragment,{}):e.jsx(e.Fragment,{})]})};export{q as N,W as i};
