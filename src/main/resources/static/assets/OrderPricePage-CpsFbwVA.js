import{r as o,R as p,x as P,b as O,A as R,B as $,u as B,g as L,j as e}from"./index-DLHo9G1O.js";import{a as b}from"./index-CHcUfME0.js";import"./lodash-ps-9DWTQ.js";import{I as E,e as F}from"./index-Secm_Y0z.js";import"./iconBase-7BRcTMO3.js";const q=()=>{var I;const[T,z]=o.useState({}),[r,v]=o.useState({}),[d,k]=o.useState({}),[i,m]=o.useState(0),[c,A]=p(P),[u,H]=p(O),[x,h]=p(R),[w,D]=p($),f=B(),n=sessionStorage.getItem("userId"),g=L();o.useEffect(()=>{const s={userId:n};(async()=>{try{const t=await b.get("/api/user/orderId",{params:s,headers:{Authorization:`Bearer ${g}`}});console.log(t.data.resultData);const l=t.data.resultData;h({...x,orderId:l}),A(l)}catch(t){console.log(t)}})()},[c]),o.useEffect(()=>{const s={orderId:c};(async()=>{try{const t=await b.get("/api/order",{params:s,headers:{Authorization:`Bearer ${g}`}});console.log(t.data.resultData);const l=t.data.resultData.totalPrice;m(l)}catch(t){console.log(t)}})()},[]);const C=async()=>{const s={orderId:c,userId:x.userId||n,point:x.point};console.log(s);try{const a=await b.post("/api/user/user-payment-member",s,{headers:{Authorization:`Bearer ${g}`}});console.log(a.data.resultData),a.data.resultData>=0?(console.log("결제 승인 요청을 보냈습니다"),f(`/user/placetoorder/request/${c}`)):console.log("요청에 실패했습니다. 다시 시도해주세요")}catch(a){console.log(a)}},y=({target:{value:s}},a)=>{console.log(s),v(t=>({...t,[a]:s}))};console.log("금액 : ",r),console.log("사람 : ",x);const N=s=>{k(t=>{const l={...t,[s]:!t[s]};return t[s]?m(j=>j+Number(r[s])):m(j=>j-Number(r[s])),l});const a=parseInt(r[s]);h(t=>({...t,point:[...t.point,a]}))},S=()=>{f(`/user/placetoorder/member/${c}`)},M=()=>{h(s=>({...s,point:[],userId:[parseInt(n)]})),D(s=>({...s})),f(-1)};return e.jsxs("div",{className:"w-full h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide",children:[e.jsxs("div",{className:"flex w-full justify-between py-6 items-center border-b border-gray",children:[e.jsx("div",{className:"flex w-[15%] justify-center",children:e.jsx(E,{className:"text-3xl",onClick:()=>M()})}),e.jsx("span",{className:"text-lg font-semibold",children:"금액 선택"}),e.jsx("div",{className:"w-[15%]",children:e.jsx("span",{className:"text-center px-3 py-1 rounded-md text-white text-opacity-0",children:"ㅇ"})})]}),e.jsxs("div",{className:"flex flex-col w-full h-full gap-6",children:[e.jsxs("div",{className:"flex w-full justify-center gap-2 pt-4 text-xl",children:[e.jsx("span",{children:"총 결제 금액 : "}),e.jsx("span",{className:`text-end px-2 ${Math.sign(parseInt(i))===-1?"text-red":"text-black"}`,children:i==null?void 0:i.toLocaleString("ko-KR")})]}),e.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[e.jsxs("span",{className:"flex w-[40%] text-base text-nowrap",children:[u.name,"(",u.uid,")"]}),e.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:d[n]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-end px-2",children:(I=r[n])==null?void 0:I.toLocaleString("ko-KR")}),e.jsx("span",{children:"원"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"tel",className:"flex w-[70%] border border-darkGray px-2 text-end rounded-md",onChange:s=>y(s,u.userId),value:r.price}),e.jsx("span",{children:"원"})]})}),e.jsx("div",{className:"flex w-[15%] justify-center gap-2 text-nowrap items-center",children:e.jsx("span",{onClick:()=>N(n),className:"bg-blue px-2 text-white font-medium rounded-md",children:d[n]?"수정":"확인"})})]}),Array.isArray(w)&&w.slice(1).map(s=>{var a;return e.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[e.jsxs("span",{className:"flex w-[40%] text-base text-nowrap",children:[s.name,"(",s.uid,")"]}),e.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:d[s.userId]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-end px-2",children:(a=r[s.userId])==null?void 0:a.toLocaleString("ko-KR")}),e.jsx("span",{children:"원"})]}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"tel",className:"flex w-[70%] border border-darkGray px-2 text-end rounded-md",onChange:t=>y(t,s.userId),value:r.price}),e.jsx("span",{children:"원"})]})}),e.jsx("div",{className:"flex w-[15%] justify-center gap-2 text-nowrap items-center",children:e.jsx("span",{onClick:()=>N(s.userId),className:"bg-blue px-2 text-white font-medium rounded-md",children:d[s.userId]?"수정":"확인"})})]},s.userId)}),e.jsx("div",{className:"flex w-full h-[5%] justify-center items-center",children:e.jsx(F,{onClick:S,className:"text-3xl"})}),e.jsx("div",{className:"flex w-full justify-center",children:e.jsx("span",{onClick:()=>C(),className:"bg-primary text-white text-lg px-2 py-1 rounded-md",children:"승인 요청"})})]})]})};export{q as default};
