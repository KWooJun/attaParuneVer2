import{r as c,R as m,b as A,x as k,t as S,u as D,g as C,j as s,S as B}from"./index-DLHo9G1O.js";import{a as d}from"./index-CHcUfME0.js";import{I as O}from"./index-Secm_Y0z.js";import{c as P}from"./index-50VzBKPQ.js";import"./iconBase-7BRcTMO3.js";const F=()=>{const[p,u]=c.useState([]),[g,$]=c.useState({}),[i,x]=c.useState({});m(A);const[o,f]=m(k),[z,y]=m(S),h=sessionStorage.getItem("userId"),j=D(),n=C();c.useEffect(()=>{const e={userId:h};(async()=>{try{const t=await d.get("/api/user/orderId",{params:e,headers:{Authorization:`Bearer ${n}`}});console.log(t.data.resultData);const a=t.data.resultData;f(a)}catch(t){console.log(t)}})()},[]),c.useEffect(()=>{const e={orderId:o};(async()=>{try{const t=await d.get("/api/user/user-payment-member/userPaymentMember",{params:e,headers:{Authorization:`Bearer ${n}`}});console.log(t.data.resultData);const a=t.data.resultData;u([...a])}catch(t){console.log(t)}})()},[]);const w=async()=>{const e={orderId:o};try{const r=await d.get("/api/user/user-payment-member/userOrderApprovalAccess",{params:e,headers:{Authorization:`Bearer ${n}`}});console.log(r.data.resultData);const t=r.data.resultData;u([...t.getApprovalStatus])}catch(r){console.log(r)}},b=async()=>{const e={orderId:parseInt(o)};try{const r=await d.post("/api/user/user-payment-member/insTicket",e,{headers:{Authorization:`Bearer ${n}`}});console.log(r.data.resultData);const t=r.data.resultData;window.sessionStorage.setItem("ticketId",t),y(t),B.fire({title:"결제 완료!",text:"식권이 생성되었습니다.",timer:2e3}),j(`/user/placetoorder/coupon/${t}`)}catch(r){console.log(r)}};console.log(o);const I=async e=>{console.log(e);const r={orderId:o,userId:e,approvalStatus:1};console.log(r);try{const t=await d.patch("/api/user/user-payment-member",r,{headers:{Authorization:`Bearer ${n}`}});console.log(t.data);const a=t.data.resultData}catch(t){console.log(t)}},N=e=>{console.log(e);const r=parseInt(g[e]);console.log("입력값",r,e),i?I(e):(u(t=>{const a=t.map(l=>l.userId===e?{...l,point:r}:l);return a.some(l=>l.userId===e)?a:[...a,{userId:e,point:r}]}),x(t=>({...t,[e]:!t[e]})))},v=e=>{x(!i)};return console.log(p),s.jsxs("div",{className:"w-full h-dvh overflow-x-hidden overflow-y-scroll scrollbar-hide",children:[s.jsxs("div",{className:"flex w-full justify-between py-6 items-center border-b border-gray",children:[s.jsx("div",{className:"flex w-[15%] justify-center",children:s.jsx(O,{className:"text-3xl"})}),s.jsx("span",{className:"text-lg font-semibold",children:"결제 상태"}),s.jsx("div",{className:"w-[15%]",children:s.jsx("span",{className:"text-center px-3 py-1 rounded-md text-white text-opacity-0",children:"ㅇ"})})]}),s.jsxs("div",{className:"flex flex-col w-full h-full gap-6",children:[s.jsx("div",{className:"flex w-full items-center justify-center mt-6",children:s.jsxs("div",{className:"flex gap-2 px-5 py-2 bg-gray rounded-md",children:[s.jsx(P,{className:"text-2xl"}),s.jsx("span",{onClick:()=>w(),className:"text-lg font-medium cursor-pointer",children:"승인 상태 확인"})]})}),Array.isArray(p)&&p.filter(e=>e.userId!==h).map(e=>s.jsxs("div",{className:"flex w-full h-[6%] px-6 justify-between items-center border-b border-gray",children:[s.jsx("span",{className:"flex w-[30%] text-base text-nowrap",children:e.name}),s.jsx("div",{className:"flex w-[35%] gap-2 items-center justify-end",children:i[e.userId]?s.jsxs(s.Fragment,{children:[s.jsx("span",{className:"text-end px-2",children:e.point}),s.jsx("span",{children:"원"})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:e.point}),s.jsx("span",{children:"원"})]})}),s.jsxs("div",{className:"flex w-[20%] justify-center gap-2 text-nowrap items-center",children:[s.jsx("span",{onClick:()=>N(e.userId),className:"bg-blue px-2 text-white font-semibold rounded-md cursor-pointer",children:"승인"}),s.jsx("span",{onClick:()=>v(e.userId),className:"bg-red px-2 text-white font-semibold rounded-md cursor-pointer",children:i[e.userId]?"수정":"취소"})]})]},e.userId)),s.jsxs("div",{className:"flex w-full justify-center gap-10",children:[s.jsx("span",{onClick:()=>b(),className:"bg-primary text-white text-lg px-2 py-1 rounded-md cursor-pointer",children:"결제 요청"}),s.jsx("span",{className:"bg-red text-white text-lg px-2 py-1 rounded-md cursor-pointer",children:"결제 취소"})]})]})]})};export{F as default};
